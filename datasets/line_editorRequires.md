# 线段编辑器(Line Editor)需求文档

## 1. 系统概述

线段编辑器是一个基于PyQt5的交互式图形界面应用，用于对线段进行可视化编辑。该应用接收numpy数组形式的二维图像数据和线段类，提供线段的选择、拖动、属性修改和保存等核心功能。

## 2. 功能需求

### 2.1 线段交互式编辑功能

- **线段选择**：通过鼠标点击选择整个线段或线段的端点
- **端点拖动**：支持拖动线段端点来调整线段位置和形状
- **属性编辑**：通过属性面板精确修改线段端点坐标(X/Y值)
- **线段删除**：删除选中的线段
- **悬停高亮**：鼠标悬停在线段上时高亮显示线段

### 2.2 可视化功能

- **图像显示**：显示输入的二维图像数据
- **线段绘制**：在图像上绘制线段，不同状态使用不同样式：
  - 原始线段：红色，细线条
  - 悬停线段：亮黄色，粗线条
  - 选中线段：亮蓝色，粗线条
- **端点标记**：线段端点使用不同颜色和大小的圆点标记

### 2.3 文件操作功能

- **线段数据保存**：支持将编辑后的线段数据保存为.pkl格式文件

## 3. 用户界面需求

### 3.1 主界面布局

- **分割视图**：左侧显示编辑画布，右侧显示控制面板
- **画布区域**：显示图像和线段，支持交互式编辑
- **控制面板**：包含功能按钮和线段属性编辑区域

### 3.2 控制面板组件

- **文件操作区域**：包含保存线段按钮
- **线段属性区域**：显示和编辑选中线段的端点坐标和长度

## 4. 输入数据要求

### 4.1 核心输入数据

- **二维图像数据**：numpy数组格式，作为编辑背景
- **线段类**：`LineSegments`类实例，包含需要编辑的线段集合

### 4.2 线段数据结构

`LineSegments`类实例需包含以下基本功能：

- 存储多条线段，每条线段包含起点和终点坐标
- 提供线段的基本操作方法
- 支持通过`save_to_file()`方法保存为.pkl格式

## 5. 技术要求

### 5.1 依赖库

- **PyQt5**：用于构建图形用户界面
- **NumPy**：用于数值计算和数组操作

### 5.2 性能要求

- 支持实时交互式编辑，拖动线段端点时保持流畅

## 6. 使用流程

1. 启动应用并加载二维图像数据和线段类
2. 在画布上交互式编辑线段（选择、拖动、修改属性）
3. 保存编辑后的线段数据(.pkl)